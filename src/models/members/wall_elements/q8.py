import numpy as np
import sympy as sp
from sympy import symbols as syms


class Node:
    def __init__(self, num, x, y):
        self.num = num
        self.x = x
        self.y = y

    def __eq__(self, other):
        return self.num == other.num

    def __hash__(self):
        return hash(('num', self.num))

    def __gt__(self, other):
        return self.num > other.num


class GaussPoint:
    def __init__(self, r, s):
        self.r = r
        self.s = s

    def __eq__(self, other):
        return self.r == other.r and self.s == other.s

    def __hash__(self):
        return hash(('r', self.r, 's', self.s))


def get_gauss_points():
    gauss_points = [
        GaussPoint(r=-0.57735, s=-0.57735),
        GaussPoint(r=+0.57735, s=-0.57735),
        GaussPoint(r=+0.57735, s=+0.57735),
        GaussPoint(r=-0.57735, s=+0.57735),
    ]
    return gauss_points


def get_nbar(r, s):
    n5 = 0.5 * (1 - r ** 2) * (1 - s)
    n6 = 0.5 * (1 + r) * (1 - s ** 2)
    n7 = 0.5 * (1 - r ** 2) * (1 + s)
    n8 = 0.5 * (1 - r) * (1 - s ** 2)

    n1 = 0.25 * (1 - r) * (1 - s) - 0.5 * (n8 + n5)
    n2 = 0.25 * (1 + r) * (1 - s) - 0.5 * (n5 + n6)
    n3 = 0.25 * (1 + r) * (1 + s) - 0.5 * (n6 + n7)
    n4 = 0.25 * (1 - r) * (1 + s) - 0.5 * (n7 + n8)

    nbar = [n1, n2, n3, n4, n5, n6, n7, n8]
    return nbar


def calculate_jacobian():
    r, s = syms('r s')
    x0, x1, x2, x3, x4, x5, x6, x7 = syms('x0 x1 x2 x3 x4 x5 x6 x7')
    y0, y1, y2, y3, y4, y5, y6, y7 = syms('y0 y1 y2 y3 y4 y5 y6 y7')
    nbars = get_nbar(r, s)
    # rx/rr
    j0 = sp.diff(nbars[0], r) * x0 + sp.diff(nbars[1], r) * x1 + sp.diff(nbars[2], r) * x2 + sp.diff(nbars[3], r) * x3 + sp.diff(nbars[4], r) * x4 + sp.diff(nbars[5], r) * x5 + sp.diff(nbars[6], r) * x6 + sp.diff(nbars[7], r) * x7
    # ry/rr
    j1 = sp.diff(nbars[0], r) * y0 + sp.diff(nbars[1], r) * y1 + sp.diff(nbars[2], r) * y2 + sp.diff(nbars[3], r) * y3 + sp.diff(nbars[4], r) * y4 + sp.diff(nbars[5], r) * y5 + sp.diff(nbars[6], r) * y6 + sp.diff(nbars[7], r) * y7
    # rx/rs
    j2 = sp.diff(nbars[0], s) * x0 + sp.diff(nbars[1], s) * x1 + sp.diff(nbars[2], s) * x2 + sp.diff(nbars[3], s) * x3 + sp.diff(nbars[4], s) * x4 + sp.diff(nbars[5], s) * x5 + sp.diff(nbars[6], s) * x6 + sp.diff(nbars[7], s) * x7
    # ry/rs
    j3 = sp.diff(nbars[0], s) * y0 + sp.diff(nbars[1], s) * y1 + sp.diff(nbars[2], s) * y2 + sp.diff(nbars[3], s) * y3 + sp.diff(nbars[4], s) * y4 + sp.diff(nbars[5], s) * y5 + sp.diff(nbars[6], s) * y6 + sp.diff(nbars[7], s) * y7
    return j0, j1, j2, j3


def get_jacobian():
    r, s = syms('r s')
    x0, x1, x2, x3, x4, x5, x6, x7 = syms('x0 x1 x2 x3 x4 x5 x6 x7')
    y0, y1, y2, y3, y4, y5, y6, y7 = syms('y0 y1 y2 y3 y4 y5 y6 y7')
    # rx/rr
    j0 = -1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5)
    # ry/rr
    j1 = -1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5)
    # rx/rs
    j2 = -2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2)
    # ry/rs
    j3 = -2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)
    return j0, j1, j2, j3


def calculate_det():
    j0, j1, j2, j3 = get_jacobian()
    return j0 * j3 - j1 * j2


def get_det(gauss_point, nodes):
    r = gauss_point.r
    s = gauss_point.s
    x0 = nodes[0].x
    x1 = nodes[1].x
    x2 = nodes[2].x
    x3 = nodes[3].x
    x4 = nodes[4].x
    x5 = nodes[5].x
    x6 = nodes[6].x
    x7 = nodes[7].x

    y0 = nodes[0].y
    y1 = nodes[1].y
    y2 = nodes[2].y
    y3 = nodes[3].y
    y4 = nodes[4].y
    y5 = nodes[5].y
    y6 = nodes[6].y
    y7 = nodes[7].y
    det = (-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))
    return det


def calculate_shape_derivatives():
    r, s = syms('r s')
    n4 = 0.5 * (1 - r ** 2) * (1 - s)
    n5 = 0.5 * (1 + r) * (1 - s ** 2)
    n6 = 0.5 * (1 - r ** 2) * (1 + s)
    n7 = 0.5 * (1 - r) * (1 - s ** 2)

    n0 = 0.25 * (1 - r) * (1 - s) - 0.5 * (n7 + n4)
    n1 = 0.25 * (1 + r) * (1 - s) - 0.5 * (n4 + n5)
    n2 = 0.25 * (1 + r) * (1 + s) - 0.5 * (n5 + n6)
    n3 = 0.25 * (1 - r) * (1 + s) - 0.5 * (n6 + n7)

    j0, j1, j2, j3 = get_jacobian()
    jinv = (1 / (j0 * j3 - j1 * j2)) * np.matrix([
        [j3, -j1],
        [-j2, j0],
    ])

    u_derivatives = sp.zeros(2, 16)
    v_derivatives = sp.zeros(2, 16)
    b = sp.zeros(3, 16)

    u_derivatives[0, :] = np.array([[sp.diff(n0, r), 0, sp.diff(n1, r), 0, sp.diff(n2, r), 0, sp.diff(n3, r), 0, sp.diff(n4, r), 0, sp.diff(n5, r), 0, sp.diff(n6, r), 0, sp.diff(n7, r), 0]])
    u_derivatives[1, :] = np.array([[sp.diff(n0, s), 0, sp.diff(n1, s), 0, sp.diff(n2, s), 0, sp.diff(n3, s), 0, sp.diff(n4, s), 0, sp.diff(n5, s), 0, sp.diff(n6, s), 0, sp.diff(n7, s), 0]])

    v_derivatives[0, :] = np.array([[0, sp.diff(n0, r), 0, sp.diff(n1, r), 0, sp.diff(n2, r), 0, sp.diff(n3, r), 0, sp.diff(n4, r), 0, sp.diff(n5, r), 0, sp.diff(n6, r), 0, sp.diff(n7, r)]])
    v_derivatives[1, :] = np.array([[0, sp.diff(n0, s), 0, sp.diff(n1, s), 0, sp.diff(n2, s), 0, sp.diff(n3, s), 0, sp.diff(n4, s), 0, sp.diff(n5, s), 0, sp.diff(n6, s), 0, sp.diff(n7, s)]])

    u_derivatives = np.dot(jinv, u_derivatives)
    v_derivatives = np.dot(jinv, v_derivatives)

    b[0, :] = u_derivatives[0, :]
    b[1, :] = v_derivatives[1, :]
    b[2, :] = u_derivatives[1, :] + v_derivatives[0, :]

    return b


def get_gauss_point_shape_derivatives(gauss_point, nodes):
    r = gauss_point.r
    s = gauss_point.s
    x0 = nodes[0].x
    x1 = nodes[1].x
    x2 = nodes[2].x
    x3 = nodes[3].x
    x4 = nodes[4].x
    x5 = nodes[5].x
    x6 = nodes[6].x
    x7 = nodes[7].x

    y0 = nodes[0].y
    y1 = nodes[1].y
    y2 = nodes[2].y
    y3 = nodes[3].y
    y4 = nodes[4].y
    y5 = nodes[5].y
    y6 = nodes[6].y
    y7 = nodes[7].y
    return np.matrix([
[(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r))*(1.0*r*y4*(1 - s) + 1.0*r*y6*(s + 1) - y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) - y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) - y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) - y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) - y5*(0.5 - 0.5*s**2) - y7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s)*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))),0, (-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5))*(1.0*r*y4*(1 - s) + 1.0*r*y6*(s + 1) - y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) - y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) - y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) - y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) - y5*(0.5 - 0.5*s**2) - y7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s)*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))),0, (0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5))*(1.0*r*y4*(1 - s) + 1.0*r*y6*(s + 1) - y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) - y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) - y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) - y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) - y5*(0.5 - 0.5*s**2) - y7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s)*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))),0, (0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r))*(1.0*r*y4*(1 - s) + 1.0*r*y6*(s + 1) - y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) - y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) - y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) - y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) - y5*(0.5 - 0.5*s**2) - y7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s)*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))),0, -1.0*r*(1 - s)*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (0.5*r**2 - 0.5)*(1.0*r*y4*(1 - s) + 1.0*r*y6*(s + 1) - y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) - y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) - y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) - y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) - y5*(0.5 - 0.5*s**2) - y7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))),0, -2*s*(0.5*r + 0.5)*(1.0*r*y4*(1 - s) + 1.0*r*y6*(s + 1) - y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) - y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) - y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) - y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) - y5*(0.5 - 0.5*s**2) - y7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (0.5 - 0.5*s**2)*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))),0, -1.0*r*(s + 1)*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (0.5 - 0.5*r**2)*(1.0*r*y4*(1 - s) + 1.0*r*y6*(s + 1) - y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) - y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) - y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) - y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) - y5*(0.5 - 0.5*s**2) - y7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))),0, -2*s*(0.5 - 0.5*r)*(1.0*r*y4*(1 - s) + 1.0*r*y6*(s + 1) - y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) - y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) - y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) - y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) - y5*(0.5 - 0.5*s**2) - y7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (0.5*s**2 - 0.5)*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))),0],[0, (-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r))*(-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s)*(2*s*x5*(0.5*r + 0.5) + 2*s*x7*(0.5 - 0.5*r) - x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) - x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) - x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x4*(0.5*r**2 - 0.5) - x6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))),0, (-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5))*(-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s)*(2*s*x5*(0.5*r + 0.5) + 2*s*x7*(0.5 - 0.5*r) - x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) - x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) - x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x4*(0.5*r**2 - 0.5) - x6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))),0, (0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5))*(-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s)*(2*s*x5*(0.5*r + 0.5) + 2*s*x7*(0.5 - 0.5*r) - x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) - x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) - x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x4*(0.5*r**2 - 0.5) - x6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))),0, (0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r))*(-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s)*(2*s*x5*(0.5*r + 0.5) + 2*s*x7*(0.5 - 0.5*r) - x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) - x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) - x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x4*(0.5*r**2 - 0.5) - x6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))),0, -1.0*r*(1 - s)*(2*s*x5*(0.5*r + 0.5) + 2*s*x7*(0.5 - 0.5*r) - x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) - x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) - x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x4*(0.5*r**2 - 0.5) - x6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (0.5*r**2 - 0.5)*(-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))),0, -2*s*(0.5*r + 0.5)*(-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (0.5 - 0.5*s**2)*(2*s*x5*(0.5*r + 0.5) + 2*s*x7*(0.5 - 0.5*r) - x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) - x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) - x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x4*(0.5*r**2 - 0.5) - x6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))),0, -1.0*r*(s + 1)*(2*s*x5*(0.5*r + 0.5) + 2*s*x7*(0.5 - 0.5*r) - x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) - x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) - x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x4*(0.5*r**2 - 0.5) - x6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (0.5 - 0.5*r**2)*(-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))),0, -2*s*(0.5 - 0.5*r)*(-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (0.5*s**2 - 0.5)*(2*s*x5*(0.5*r + 0.5) + 2*s*x7*(0.5 - 0.5*r) - x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) - x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) - x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x4*(0.5*r**2 - 0.5) - x6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2)))],
[(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r))*(-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s)*(2*s*x5*(0.5*r + 0.5) + 2*s*x7*(0.5 - 0.5*r) - x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) - x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) - x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x4*(0.5*r**2 - 0.5) - x6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))), (-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r))*(1.0*r*y4*(1 - s) + 1.0*r*y6*(s + 1) - y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) - y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) - y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) - y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) - y5*(0.5 - 0.5*s**2) - y7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s)*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))), (-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5))*(-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s)*(2*s*x5*(0.5*r + 0.5) + 2*s*x7*(0.5 - 0.5*r) - x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) - x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) - x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x4*(0.5*r**2 - 0.5) - x6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))), (-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5))*(1.0*r*y4*(1 - s) + 1.0*r*y6*(s + 1) - y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) - y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) - y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) - y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) - y5*(0.5 - 0.5*s**2) - y7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s)*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))), (0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5))*(-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s)*(2*s*x5*(0.5*r + 0.5) + 2*s*x7*(0.5 - 0.5*r) - x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) - x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) - x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x4*(0.5*r**2 - 0.5) - x6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))), (0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5))*(1.0*r*y4*(1 - s) + 1.0*r*y6*(s + 1) - y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) - y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) - y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) - y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) - y5*(0.5 - 0.5*s**2) - y7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s)*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))), (0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r))*(-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s)*(2*s*x5*(0.5*r + 0.5) + 2*s*x7*(0.5 - 0.5*r) - x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) - x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) - x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x4*(0.5*r**2 - 0.5) - x6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))), (0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r))*(1.0*r*y4*(1 - s) + 1.0*r*y6*(s + 1) - y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) - y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) - y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) - y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) - y5*(0.5 - 0.5*s**2) - y7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s)*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))), -1.0*r*(1 - s)*(2*s*x5*(0.5*r + 0.5) + 2*s*x7*(0.5 - 0.5*r) - x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) - x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) - x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x4*(0.5*r**2 - 0.5) - x6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (0.5*r**2 - 0.5)*(-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))), -1.0*r*(1 - s)*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (0.5*r**2 - 0.5)*(1.0*r*y4*(1 - s) + 1.0*r*y6*(s + 1) - y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) - y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) - y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) - y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) - y5*(0.5 - 0.5*s**2) - y7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))), -2*s*(0.5*r + 0.5)*(-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (0.5 - 0.5*s**2)*(2*s*x5*(0.5*r + 0.5) + 2*s*x7*(0.5 - 0.5*r) - x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) - x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) - x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x4*(0.5*r**2 - 0.5) - x6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))), -2*s*(0.5*r + 0.5)*(1.0*r*y4*(1 - s) + 1.0*r*y6*(s + 1) - y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) - y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) - y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) - y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) - y5*(0.5 - 0.5*s**2) - y7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (0.5 - 0.5*s**2)*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))), -1.0*r*(s + 1)*(2*s*x5*(0.5*r + 0.5) + 2*s*x7*(0.5 - 0.5*r) - x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) - x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) - x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x4*(0.5*r**2 - 0.5) - x6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (0.5 - 0.5*r**2)*(-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))), -1.0*r*(s + 1)*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (0.5 - 0.5*r**2)*(1.0*r*y4*(1 - s) + 1.0*r*y6*(s + 1) - y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) - y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) - y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) - y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) - y5*(0.5 - 0.5*s**2) - y7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))), -2*s*(0.5 - 0.5*r)*(-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (0.5*s**2 - 0.5)*(2*s*x5*(0.5*r + 0.5) + 2*s*x7*(0.5 - 0.5*r) - x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) - x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) - x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) - x4*(0.5*r**2 - 0.5) - x6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))), -2*s*(0.5 - 0.5*r)*(1.0*r*y4*(1 - s) + 1.0*r*y6*(s + 1) - y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) - y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) - y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) - y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) - y5*(0.5 - 0.5*s**2) - y7*(0.5*s**2 - 0.5))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2))) + (0.5*s**2 - 0.5)*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2))/((-1.0*r*x4*(1 - s) - 1.0*r*x6*(s + 1) + x0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + x1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + x2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + x3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + x5*(0.5 - 0.5*s**2) + x7*(0.5*s**2 - 0.5))*(-2*s*y5*(0.5*r + 0.5) - 2*s*y7*(0.5 - 0.5*r) + y0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + y2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + y3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + y4*(0.5*r**2 - 0.5) + y6*(0.5 - 0.5*r**2)) - (-1.0*r*y4*(1 - s) - 1.0*r*y6*(s + 1) + y0*(-1.0*r*(0.5*s - 0.5) - 0.25*s**2 + 0.25*s) + y1*(-1.0*r*(0.5*s - 0.5) + 0.25*s**2 - 0.25*s) + y2*(-1.0*r*(-0.5*s - 0.5) + 0.25*s**2 + 0.25*s) + y3*(-1.0*r*(-0.5*s - 0.5) - 0.25*s**2 - 0.25*s) + y5*(0.5 - 0.5*s**2) + y7*(0.5*s**2 - 0.5))*(-2*s*x5*(0.5*r + 0.5) - 2*s*x7*(0.5 - 0.5*r) + x0*(-0.25*r**2 + 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x1*(-0.25*r**2 - 0.25*r + 1.0*s*(0.5*r + 0.5)) + x2*(0.25*r**2 + 0.25*r + 1.0*s*(0.5*r + 0.5)) + x3*(0.25*r**2 - 0.25*r + 1.0*s*(0.5 - 0.5*r)) + x4*(0.5*r**2 - 0.5) + x6*(0.5 - 0.5*r**2)))]])

def get_stiffness(gauss_points, nodes, thickness):
    k = np.matrix(np.zeros((16, 16)))
    nu = 0.3
    e = 2e11
    c = np.matrix([[1, nu, 0],
                   [nu, 1, 0],
                   [0, 0, (1 - nu) / 2]])
    ce = (e / (1 - nu ** 2)) * c
    for gauss_point in gauss_points:
        gauss_point_b = get_gauss_point_shape_derivatives(gauss_point, nodes)
        gauss_point_det = get_det(gauss_point, nodes)
        gauss_point_k = gauss_point_b.T * ce * gauss_point_b * gauss_point_det * thickness
        k += gauss_point_k
    return k


def get_nodal_disp():
    thickness = 0.01
    fx = 2000000
    fy = -1500000
    nodes = [
        Node(num=0, x=0, y=3),
        Node(num=1, x=1, y=1.5),
        Node(num=2, x=2, y=0),
        Node(num=3, x=2.5, y=3),
        Node(num=4, x=3, y=6),
        Node(num=5, x=1.75, y=5.5),
        Node(num=6, x=0.5, y=5),
        Node(num=6, x=0.25, y=4),
    ]
    gauss_points = get_gauss_points()
    k = get_stiffness(gauss_points, nodes, thickness)
    kr = k[6:16, 6:16]
    fr = np.matrix([[0, 0, fx, fy, 0, 0, 0, 0, 0, 0]]).T
    return np.linalg.inv(kr) * fr

if __name__ == "__main__":
    disp = get_nodal_disp()
    print(disp)
